function ucfirst(e){return e?e[0].toUpperCase()+e.substr(1):e}function addNamespace(e){return(CONST.IMPLICIT_NAMESPACES[e]||CONST.NAMESPACE_DEFAULT)+"."+e}function processStyle(e,t,i,s,r){s=s||{},s.classes=i,t.apiName&&(s.apiName=t.apiName),t.id&&(s.id=t.id),t.applyProperties(exports.createStyle(e,s,r))}function isTabletFallback(){return Math.min(Ti.Platform.displayCaps.platformHeight,Ti.Platform.displayCaps.platformWidth)>=700}function deepExtend(){var e,t,i,s,r,o,a=arguments[0]||{},l=1,n=arguments.length,y=!1;for("boolean"==typeof a&&(y=a,a=arguments[1]||{},l=2),"object"==typeof a||_.isFunction(a)||(a={});n>l;l++)if(e=arguments[l],null!=e){"string"==typeof e&&(e=e.split(""));for(t in e)i=a[t],s=e[t],a!==s&&(y&&s&&(_.isObject(s)&&!_.has(s,"apiName")||(r=_.isArray(s)))&&!s.colors?(r?(r=!1,o=i&&_.isArray(i)?i:[]):o=_.isDate(s)?new Date(s.valueOf()):i&&_.isObject(i)?i:{},a[t]=deepExtend(y,o,s)):"undefined"!=typeof s?a[t]=s:s.colors&&(a[t]=s))}return a}var _=require("alloy/underscore")._,Backbone=require("alloy/backbone"),CONST=require("alloy/constants");exports.version="1.5.1",exports._=_,exports.Backbone=Backbone;var DEFAULT_WIDGET="widget",TI_VERSION=Ti.version,MW320_CHECK=!1,IDENTITY_TRANSFORM=void 0,RESET={bottom:null,left:null,right:null,top:null,height:null,width:null,shadowColor:null,shadowOffset:null,backgroundImage:null,backgroundRepeat:null,center:null,layout:null,backgroundSelectedColor:null,backgroundSelectedImage:null,opacity:1,touchEnabled:!0,enabled:!0,horizontalWrap:!0,zIndex:0,backgroundColor:null,font:null,visible:!0,color:null,transform:null,backgroundGradient:{},borderColor:"transparent",borderRadius:0,borderWidth:0};RESET=_.extend(RESET,{backgroundLeftCap:0,backgroundTopCap:0}),exports.M=function(e,t,i){var s,r=(t||{}).config||{},o=r.adapter||{},a={},l={};o.type?(s=require("alloy/sync/"+o.type),a.sync=function(e,t,i){s.sync(e,t,i)}):a.sync=function(e,t){Ti.API.warn("Execution of "+e+"#sync() function on a model that does not support persistence"),Ti.API.warn("model: "+JSON.stringify(t.toJSON()))},a.defaults=r.defaults,i&&(l.migrations=i),s&&_.isFunction(s.beforeModelCreate)&&(r=s.beforeModelCreate(r,e)||r);var n=Backbone.Model.extend(a,l);return n.prototype.config=r,_.isFunction(t.extendModel)&&(n=t.extendModel(n)||n),s&&_.isFunction(s.afterModelCreate)&&s.afterModelCreate(n,e),n},exports.C=function(e,t,i){var s,r={model:i},o=(i?i.prototype.config:{})||{};o.adapter&&o.adapter.type?(s=require("alloy/sync/"+o.adapter.type),r.sync=function(e,t,i){s.sync(e,t,i)}):r.sync=function(e,t){Ti.API.warn("Execution of "+e+"#sync() function on a collection that does not support persistence"),Ti.API.warn("model: "+JSON.stringify(t.toJSON()))};var a=Backbone.Collection.extend(r);return a.prototype.config=o,_.isFunction(t.extendCollection)&&(a=t.extendCollection(a)||a),s&&_.isFunction(s.afterCollectionCreate)&&s.afterCollectionCreate(a),a},exports.UI={},exports.UI.create=function(controller,apiName,opts){opts=opts||{};var baseName,ns,parts=apiName.split(".");if(1===parts.length)baseName=apiName,ns=opts.ns||CONST.IMPLICIT_NAMESPACES[baseName]||CONST.NAMESPACE_DEFAULT;else{if(!(parts.length>1))throw"Alloy.UI.create() failed: No API name was given in the second parameter";baseName=parts[parts.length-1],ns=parts.slice(0,parts.length-1).join(".")}opts.apiName=ns+"."+baseName,baseName=baseName[0].toUpperCase()+baseName.substr(1);var style=exports.createStyle(controller,opts);return eval(ns)["create"+baseName](style)},exports.createStyle=function(e,t,i){var s,r;if(!t)return{};s=_.isArray(t.classes)?t.classes.slice(0):_.isString(t.classes)?t.classes.split(/\s+/):[],r=t.apiName,r&&-1===r.indexOf(".")&&(r=addNamespace(r));var o;o=require(e&&_.isObject(e)?"alloy/widgets/"+e.widgetId+"/styles/"+e.name:"alloy/styles/"+e);var a,l,n={};for(a=0,l=o.length;l>a;a++){var y=o[a],d=y.key;if(y.isApi&&-1===d.indexOf(".")&&(d=(CONST.IMPLICIT_NAMESPACES[d]||CONST.NAMESPACE_DEFAULT)+"."+d),y.isId&&t.id&&y.key===t.id||y.isClass&&_.contains(s,y.key));else{if(!y.isApi)continue;if(-1===y.key.indexOf(".")&&(y.key=addNamespace(y.key)),y.key!==r)continue}y.queries&&y.queries.formFactor&&!Alloy[y.queries.formFactor]||deepExtend(!0,n,y.style)}var p=_.omit(t,[CONST.CLASS_PROPERTY,CONST.APINAME_PROPERTY]);return deepExtend(!0,n,p),n[CONST.CLASS_PROPERTY]=s,n[CONST.APINAME_PROPERTY]=r,MW320_CHECK&&delete n[CONST.APINAME_PROPERTY],i?_.defaults(n,i):n},exports.addClass=function(e,t,i,s){if(!i)return void(s&&(MW320_CHECK&&delete s.apiName,t.applyProperties(s)));var r=t[CONST.CLASS_PROPERTY]||[],o=r.length;i=_.isString(i)?i.split(/\s+/):i;var a=_.union(r,i||[]);return o===a.length?void(s&&(MW320_CHECK&&delete s.apiName,t.applyProperties(s))):void processStyle(e,t,a,s)},exports.removeClass=function(e,t,i,s){i=i||[];var r=t[CONST.CLASS_PROPERTY]||[],o=r.length;if(!o||!i.length)return void(s&&(MW320_CHECK&&delete s.apiName,t.applyProperties(s)));i=_.isString(i)?i.split(/\s+/):i;var a=_.difference(r,i);return o===a.length?void(s&&(MW320_CHECK&&delete s.apiName,t.applyProperties(s))):void processStyle(e,t,a,s,RESET)},exports.resetClass=function(e,t,i,s){i=i||[],i=_.isString(i)?i.split(/\s+/):i,processStyle(e,t,i,s,RESET)},exports.createWidget=function(e,t,i){return"undefined"!=typeof t&&null!==t&&_.isObject(t)&&!_.isString(t)&&(i=t,t=DEFAULT_WIDGET),new(require("alloy/widgets/"+e+"/controllers/"+(t||DEFAULT_WIDGET)))(i)},exports.createController=function(e,t){return new(require("alloy/controllers/"+e))(t)},exports.createModel=function(e,t){return new(require("alloy/models/"+ucfirst(e)).Model)(t)},exports.createCollection=function(e,t){return new(require("alloy/models/"+ucfirst(e)).Collection)(t)},exports.isTablet=function(){return"ipad"===Ti.Platform.osname}(),exports.isHandheld=!exports.isTablet,exports.Globals={},exports.Models={},exports.Models.instance=function(e){return exports.Models[e]||(exports.Models[e]=exports.createModel(e))},exports.Collections={},exports.Collections.instance=function(e){return exports.Collections[e]||(exports.Collections[e]=exports.createCollection(e))},exports.CFG=require("alloy/CFG");