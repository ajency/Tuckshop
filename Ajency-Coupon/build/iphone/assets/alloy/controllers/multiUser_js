function __processArg(e,t){var i=null;return e&&(i=e[t]||null,delete e[t]),i}function Controller(){function e(){var e={title:""};Alloy.createController("index",e).getView().open()}function t(){d=s=[],i.usersTable.data=[],d=dbOperations.getUsersInfo(),0===d.length?Alloy.createController("index",{}).getView().open():(1===d.length&&(enteredEmailValue=d[0].username.split("@"),o.saveLastLoggedInUserId(d[0].id),o.saveDisplayName(enteredEmailValue[0])),c(d))}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="multiUser",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var i=this,a={},n={};i.__views.multiWindow=Ti.UI.createWindow({backgroundColor:"transparent",opacity:1,width:Ti.UI.FILL,height:Ti.UI.FILL,layout:"vertical",navBarHidden:!0,backgroundImage:"/background.jpg",id:"multiWindow"}),i.__views.multiWindow&&i.addTopLevelView(i.__views.multiWindow),i.__views.__alloyId14=Ti.UI.createView({layout:"vertical",top:0,height:"80%",id:"__alloyId14"}),i.__views.multiWindow.add(i.__views.__alloyId14),i.__views.__alloyId15=Ti.UI.createView({layout:"vertical",width:Ti.UI.FILL,height:Ti.UI.SIZE,top:"5%",id:"__alloyId15"}),i.__views.__alloyId14.add(i.__views.__alloyId15),i.__views.companyLogo=Ti.UI.createImageView({image:"/images/tuckshopLogo.png",width:"45%",height:"29%",id:"companyLogo"}),i.__views.__alloyId15.add(i.__views.companyLogo),i.__views.__alloyId16=Ti.UI.createLabel({font:{fontFamily:"OpenSans-Regular",fontSize:22,fontWeight:"bold"},textAlign:"center",width:Ti.UI.FILL,color:"#3B0B0B",text:"Choose an account",top:"3%",id:"__alloyId16"}),i.__views.__alloyId15.add(i.__views.__alloyId16),i.__views.__alloyId17=Ti.UI.createView({height:"42.5%",top:"2%",id:"__alloyId17"}),i.__views.__alloyId15.add(i.__views.__alloyId17),i.__views.usersTable=Ti.UI.createTableView({width:Ti.UI.FILL,left:"5%",right:"5%",id:"usersTable",height:Ti.UI.SIZE,top:"0%",separatorStyle:"none",backgroundColor:"transparent"}),i.__views.__alloyId17.add(i.__views.usersTable),i.__views.newAccountButton=Ti.UI.createButton({font:{fontFamily:"OpenSans-Regular",fontSize:15},width:"70%",left:"15%",right:"15%",color:"#F0C60A",backgroundColor:"#585858",title:"Add new account",height:"11%",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,id:"newAccountButton",top:"3%",bottom:"0%"}),i.__views.__alloyId15.add(i.__views.newAccountButton),e?i.__views.newAccountButton.addEventListener("click",e):n["$.__views.newAccountButton!click!newAccountClicked"]=!0,i.__views.__alloyId18=Ti.UI.createView({layout:"horizontal",width:Ti.UI.FILL,bottom:0,height:"20%",id:"__alloyId18"}),i.__views.multiWindow.add(i.__views.__alloyId18),i.__views.__alloyId19=Ti.UI.createImageView({width:Ti.UI.FILL,height:Ti.UI.FILL,image:"/images/footer.png",id:"__alloyId19"}),i.__views.__alloyId18.add(i.__views.__alloyId19),a.destroy=function(){},_.extend(i,i.__views),arguments[0]||{};var o=require("/localStorage"),r=outerView=leftView=rightView=deleteUserView=expandImageView=nameLabel=null,s=empty=[];if(o.getOrganizationId()&&dbOperations.checkOrganizationPresent(o.getOrganizationId())){var l=dbOperations.getOrganizationRow(o.getOrganizationId());i.companyLogo.image=l[0].organization_logo}dbOperations.logoutUsers();var d=dbOperations.getUsersInfo(),c=function(e){for(var a=0;a<_.size(e);a++)r=Ti.UI.createTableViewRow({id:e[a].id,height:50,backgroundSelectedColor:"transparent",backgroundColor:"transparent"}),outerView=Ti.UI.createView({layout:"horizontal",left:0,top:.8,bottom:.8,width:Ti.UI.FILL,backgroundColor:"#3B0B0B",opacity:.8}),leftView=Ti.UI.createView({layout:"vertical",top:"20%",left:"2%",height:"60%",width:"10%"}),deleteUserView=Ti.UI.createImageView({image:"/images/delete_user.png",width:Ti.UI.SIZE,height:Ti.UI.FILL,id:a}),outerRightView=Ti.UI.createView({id:a,layout:"horizontal",height:Ti.UI.FILL,width:"88%"}),centerView=Ti.UI.createView({id:a,layout:"vertical",height:Ti.UI.FILL,width:"89.5%"}),nameLabel=Ti.UI.createLabel({touchEnabled:!1,top:"20%",left:20,text:e[a].username,color:"#F0C60A",font:{fontFamily:"OpenSans-Regular",fontSize:20}}),rightView=Ti.UI.createView({layout:"vertical",top:"20%",height:"60%",width:"10%"}),expandImageView=Ti.UI.createImageView({image:"/images/expand-arrow.png",left:"5%",width:Ti.UI.SIZE,height:Ti.UI.FILL,id:a,right:"0%"}),leftView.add(deleteUserView),deleteUserView.addEventListener("click",function(e){e.cancelBubble=!0,dbOperations.deleteUser(d[e.source.id].id),setTimeout(function(){t()},1e3)}),centerView.add(nameLabel),rightView.add(expandImageView),outerRightView.add(centerView),outerRightView.add(rightView),outerRightView.addEventListener("click",function(e){e.cancelBubble=!0;var t={title:d[e.source.id].username};Alloy.createController("index",t).getView().open()}),outerView.add(leftView),outerView.add(outerRightView),r.add(outerView),s.push(r),r=outerView=leftView=deleteUserView=expandImageView=rightView=nameLabel=null;i.usersTable.data=s};c(d),n["$.__views.newAccountButton!click!newAccountClicked"]&&i.__views.newAccountButton.addEventListener("click",e),_.extend(i,a)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;