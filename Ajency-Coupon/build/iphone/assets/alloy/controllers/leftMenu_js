function __processArg(e,t){var i=null;return e&&(i=e[t]||null,delete e[t]),i}function Controller(){function e(){a.animateObject.image="/images/loaderlogin-"+m+".png",m++,5===m&&(m=1)}function t(e){for(i=0;len=_.size(u),len>i;i++)u[i].id!=e&&u[i].setBackgroundColor("transparent")}function n(e){rowId=e.source.id,c.Globals.navigatedView=rowId;var i={id:rowId};switch(t(rowId),e.source.backgroundColor="#F0C60A",rowId){case"Home":Ti.App.fireEvent("menu:toggleLeftMenu"),Ti.App.fireEvent("app:addViewToMidContainer",i),i=null;break;case"Transaction History":Ti.App.fireEvent("menu:toggleLeftMenu"),Ti.App.fireEvent("app:addViewToMidContainer",i),i=null;break;case"Manage":Ti.App.fireEvent("menu:toggleLeftMenu"),Ti.App.fireEvent("app:addViewToMidContainer",i),i=null;break;case"Pending":Ti.App.fireEvent("menu:toggleLeftMenu"),Ti.App.fireEvent("app:addViewToMidContainer",i),i=null;break;case"Stock":Ti.App.fireEvent("menu:toggleLeftMenu"),Ti.App.fireEvent("app:addViewToMidContainer",i),i=null;break;case"Settings":Ti.App.fireEvent("menu:toggleLeftMenu"),Ti.App.fireEvent("app:addViewToMidContainer",i),i=null;break;case"Logout":r();break;default:console.log("Invalid row")}}function o(){0==g.getNetworkStatus()?alert("No Internet Connection"):(w(),d=setInterval(e,200),a.menuTable.visible=!1,a.leftMenuRefreshLabel.visible=!1,"fetchCategories"===p?f.fetchCategories("leftMenu"):"fetchCloudProducts"===p?f.fetchCloudProducts("leftMenu"):"transactionsOnProductIds"===p?f.transactionsOnProductIds("leftMenu"):"transactionsOnProductIdsGreaterThanThousand"===p&&f.transactionsOnProductIdsGreaterThanThousand("leftMenu"))}function r(){0==g.getNetworkStatus()?alert("No Internet Connection"):(w(),d=setInterval(e,200),a.menuTable.visible=!1,a.leftMenuRefreshLabel.visible=!1,Cloud.Users.logout(function(e){if(e.success){v(),clearInterval(d),Ti.App.Properties.removeProperty("sessionID"),a.menuTable.visible=!0,a.leftMenuRefreshLabel.visible=!0,dbOperations.updateSessionId(localStorage.getLastLoggedInUserId()),dbOperations.offlineLoginStatus(localStorage.getLastLoggedInUserId()),c.Globals.autoLogin=!1,c.Globals.userResponse=[];var t=dbOperations.getCount();t>1?(null!=c.Globals.logoutInterval&&clearTimeout(c.Globals.logoutInterval),Alloy.createController("multiUser",{}).getView().open()):(Ti.App.fireEvent("menu:toggleLeftMenu"),c.Globals.populateLeftMenu())}else v(),clearInterval(d),a.menuTable.visible=!0,a.leftMenuRefreshLabel.visible=!0,alert("Could not connect to server. Try again ")}))}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="leftMenu",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var a=this,s={},l={};a.__views.leftMenu=Ti.UI.createView({backgroundColor:"#FFFFFF",opacity:1,width:Ti.UI.FILL,height:Ti.UI.FILL,layout:"vertical",navBarHidden:!0,id:"leftMenu"}),a.__views.leftMenu&&a.addTopLevelView(a.__views.leftMenu),a.__views.__alloyId54=Ti.UI.createView({layout:"vertical",width:Ti.UI.FILL,left:0,top:0,height:"85%",id:"__alloyId54"}),a.__views.leftMenu.add(a.__views.__alloyId54),a.__views.__alloyId55=Ti.UI.createView({height:"25%",id:"__alloyId55"}),a.__views.__alloyId54.add(a.__views.__alloyId55),a.__views.menuHeaderIcon=Ti.UI.createImageView({width:Ti.UI.FILL,height:Ti.UI.FILL,id:"menuHeaderIcon",image:"/images/menu_header.png"}),a.__views.__alloyId55.add(a.__views.menuHeaderIcon),a.__views.__alloyId56=Ti.UI.createView({top:"2%",height:"7%",id:"__alloyId56"}),a.__views.__alloyId54.add(a.__views.__alloyId56),a.__views.lbl_username=Ti.UI.createLabel({font:{fontFamily:"OpenSans-Regular",fontSize:25},left:"10%",color:"#3B0B0B",id:"lbl_username",text:"Hello User!"}),a.__views.__alloyId56.add(a.__views.lbl_username),a.__views.__alloyId57=Ti.UI.createView({top:"4%",height:"4%",id:"__alloyId57"}),a.__views.__alloyId54.add(a.__views.__alloyId57),a.__views.lbl_credit=Ti.UI.createLabel({font:{fontFamily:"OpenSans-Regular",fontSize:15},left:"10%",color:"#3B0B0B",id:"lbl_credit",text:"Your available credit is"}),a.__views.__alloyId57.add(a.__views.lbl_credit),a.__views.__alloyId58=Ti.UI.createView({layout:"horizontal",top:"2%",height:"12%",id:"__alloyId58"}),a.__views.__alloyId54.add(a.__views.__alloyId58),a.__views.__alloyId59=Ti.UI.createView({width:"25%",id:"__alloyId59"}),a.__views.__alloyId58.add(a.__views.__alloyId59),a.__views.rupeeSymbol=Ti.UI.createImageView({right:0,top:"37.5%",bottom:"37.5%",height:"25%",width:"15%",id:"rupeeSymbol"}),a.__views.__alloyId59.add(a.__views.rupeeSymbol),a.__views.__alloyId60=Ti.UI.createView({width:"75%",id:"__alloyId60"}),a.__views.__alloyId58.add(a.__views.__alloyId60),a.__views.lbl_availableCredit=Ti.UI.createLabel({textAlign:"center",color:"#3B0B0B",left:"1%",font:{fontFamily:"OpenSans-Bold",fontSize:35},id:"lbl_availableCredit",text:""}),a.__views.__alloyId60.add(a.__views.lbl_availableCredit),a.__views.animateObject=Ti.UI.createImageView({id:"animateObject",height:"0",width:"0",top:"0",image:"/images/loader-1.png"}),a.__views.__alloyId54.add(a.__views.animateObject),a.__views.menuTable=Ti.UI.createTableView({width:Ti.UI.FILL,id:"menuTable",top:"3%",height:"31%",separatorColor:"#F0C60A"}),a.__views.__alloyId54.add(a.__views.menuTable),n?a.__views.menuTable.addEventListener("click",n):l["$.__views.menuTable!click!onMenuTableClick"]=!0,a.__views.__alloyId61=Ti.UI.createView({top:"2%",height:"4%",id:"__alloyId61"}),a.__views.__alloyId54.add(a.__views.__alloyId61),a.__views.leftMenuRefreshLabel=Ti.UI.createLabel({text:"Refresh",id:"leftMenuRefreshLabel",left:"35%",height:"40",width:"200"}),a.__views.__alloyId61.add(a.__views.leftMenuRefreshLabel),o?a.__views.leftMenuRefreshLabel.addEventListener("click",o):l["$.__views.leftMenuRefreshLabel!click!refreshClick"]=!0,a.__views.__alloyId62=Ti.UI.createView({layout:"horizontal",width:Ti.UI.FILL,left:0,bottom:0,height:"15%",id:"__alloyId62"}),a.__views.leftMenu.add(a.__views.__alloyId62),a.__views.menu_footer=Ti.UI.createImageView({width:Ti.UI.FILL,height:Ti.UI.FILL,id:"menu_footer",image:"/images/footer.png"}),a.__views.__alloyId62.add(a.__views.menu_footer),s.destroy=function(){},_.extend(a,a.__views);var d,c=require("alloy"),u=[],h=label=null,f=require("/fetchCloudProducts"),g=require("/networkCheck"),p="fetchCategories",m=1,w=function(){a.animateObject.height=96,a.animateObject.width=96},v=function(){a.animateObject.height=0,a.animateObject.width=0};Alloy.Globals.populateLeftMenu=function(){u=[];var e=null,t=dbOperations.getLoginStatus(localStorage.getLastLoggedInUserId());e=t?"true"===dbOperations.getUserType(localStorage.getLastLoggedInUserId())?["Home","Transaction History","Manage","Stock","Settings","Logout"]:"cook"===dbOperations.getUserRole(localStorage.getLastLoggedInUserId())?["Home","Transaction History","Pending","Stock","Settings","Logout"]:["Home","Transaction History","Settings","Logout"]:["Home","Transaction History"];for(var i=0;len=_.size(e),len>i;i++)h=Ti.UI.createTableViewRow({id:e[i],height:40,focusable:!0,backgroundSelectedColor:"transparent"}),label=Ti.UI.createLabel({touchEnabled:!1,left:"10%",text:e[i],textAlign:"left",color:"#3B0B0B",font:{fontFamily:"OpenSans-Regular",fontSize:15}}),h.add(label),u.push(h),h=label=null;a.menuTable.data=u,a.rupeeSymbol.image=localStorage.getCurrencyUrl()},c.Globals.populateLeftMenu(),a.menuTable.setSeparatorInsets({left:0}),u[0].setBackgroundColor("#F0C60A"),Ti.App.addEventListener("errorOnFetch",function(e){v(),null!=d&&clearInterval(d),a.menuTable.visible=!0,a.leftMenuRefreshLabel.visible=!0,a.leftMenuRefreshLabel.text="Error. Try Again",p=e.name}),c.Globals.successOnRefresh=function(){console.log("Success on fetch"),v(),null!=d&&clearInterval(d),a.menuTable.visible=!0,a.leftMenuRefreshLabel.visible=!0,a.leftMenuRefreshLabel.text="Refresh",Ti.App.fireEvent("refreshCategories")},Ti.App.addEventListener("successOnFetch",c.Globals.successOnRefresh),Ti.App.addEventListener("Calculate",function(e){a.lbl_availableCredit.text=e.value}),Ti.App.addEventListener("Display",function(e){a.lbl_username.text="Hello "+e.displayValue}),l["$.__views.menuTable!click!onMenuTableClick"]&&a.__views.menuTable.addEventListener("click",n),l["$.__views.leftMenuRefreshLabel!click!refreshClick"]&&a.__views.leftMenuRefreshLabel.addEventListener("click",o),_.extend(a,s)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;